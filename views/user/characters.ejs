
<div class="container mt-4">
  <h2>我的角色</h2>
  
  <% if (flash.success && flash.success.length > 0) { %>
    <div class="alert alert-success"><%= flash.success[0] %></div>
  <% } %>
  <% if (flash.error && flash.error.length > 0) { %>
    <div class="alert alert-danger"><%= flash.error[0] %></div>
  <% } %>

  <!-- 新增：创建角色入口 -->
  <a href="/characters/create?account_id=<%= currentAccountId %>" class="btn btn-primary mb-3">创建新角色</a>

  <table class="table table-striped">
    <thead>
      <tr>
        <th>所属账户</th>
        <th>角色名称</th>
        <th>等级</th>
        <th>最大血量</th>
        <th>基础攻击</th>
        <th>基础防御</th>
        <th>装备攻击</th>
        <th>装备防御</th>
        <th>总攻击</th>
        <th>总防御</th>
        <th>角色id</th>
        <th>操作</th><!-- 新增：操作列 -->
      </tr>
    </thead>
    <tbody>
      <% if (characters && characters.length > 0) { %>  <!-- 新增空值检查 -->
        <% characters.forEach(c => { %>
          <tr>
            <td><%= c.account_id %></td>
          <td><%= c.char_name %></td>
          <td><%= c.level %></td>
          <td><%= c.hp_max %></td>
          <td><%= c.attack %></td>
          <td><%= c.defense %></td>
          <td><%= c.equip_attack || '无'%></td>
          <td><%= c.equip_defense || '无'%></td>
          <td><%= c.total_attack %></td>
          <td><%= c.total_defense %></td>
          <td><%= c.char_id %></td>
          <td>
              <a href="/characters/delete/<%= c.char_id %>" class="btn btn-sm btn-danger">删除</a>
            </td> 
            
           
          </tr>
        <% }); %>
      <% } else { %>  <!-- 无角色时的提示 -->
        <tr>
          <td colspan="100%" class="text-center">暂无角色</td>
        </tr>
      <% } %>
    </tbody>
  </table>
</div>